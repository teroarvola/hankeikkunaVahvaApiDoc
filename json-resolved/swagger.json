{
  "openapi" : "3.0.0",
  "info" : {
    "title" : "Hankeikkunan VAHVA-asianhallintaa palveleva rajapinta",
    "description" : "# Esittely\nTällä rajapinnalla VAHVA-asianhallintajärjestelmä käynnistää uuden kohteen lisäämisen Hankeikkunaan ja hallinnoi liitoksen sisältöä.\nHankeikkuna hakee VAHVAn \"yleisrajapinnasta\" välitettyjen tunnisteiden avulla tarvitsemansa tiedot asioista, asiakirjoista ja tiedostoista.\nHankeikkunan pitää varautua siihen, että liitoksen päivityksen yhteydessä tiedostoja voidaan lisätä tai poistaa Hankeikkunasta.\n# TODO / huomioita ja kysymyksiä\n* Rajapinta on nyt suomeksi - Hankeikkunan tietomalli on suomeksi. Voisi olla myös englanniksi.\n* Kohdetyyppien kooditus on esimerkeissä keksitty.\n# Muutosloki\n* Lisätty GET /api/v1/vahva-sidos/{caseRecno} -hakuun mahdollisuus hakea myös (migratoidun) asian diaarinumerolla. Tämä mahdollistaa auttavan VAHVA-Hankeikkuna -linkityksen tekemisen myös migratoiduille asioille / Riku Sarlin 2018-08-15\n* Poistettu session-käsittely / Riku Sarlin 2018-08-20 => basic auth\n* Päivitetty HTTP-virhekoodit ja virheiden kuvaukset. / Lasse Laasonen 2019-03-13 * AsiaJulkaisuTapa ja AsiakirjaJulkaisuTapa vaihtoehdot päivitetty. / Lasse Laasonen 2019-03-13\n* Uudelleennimetty AsiakirjaSidos tyypin kentät asiakirjaRecno ja fileId --> recordRecno ja documentRecno  2019-03-28\n* Muutettu GET /api/v1/vahva-sidos/{caseRecno} metodin diaariNro-parametri hanketunnus-parametriksi / Lasse Laasonen 2019-04-11 \n* Muutettu AsiaJulkaisuTapa ja AsiakirjaJulkaisuTapa arvojoukkoja / Lasse Laasonen 2019-04-24\n* Muutettu POST ja PUT /api/v1/vahva-sidos/{caseRecno} metodin bodya, jossa mukana nyt myös toimija / Lasse Laasonen 2019-05-15\n* Lisätty documentVersionRecno AsiakirjaSidokseen / Lasse Laasonen 2019-05-15\n* Muutettu Toimija#sAMAccountName --> sposti / Lasse Laasonen 2019-05-22\n* Lisätty JSON vastaus kun palautetaan HTTP 500 / Lasse Laasonen 2019-06-24\n",
    "contact" : {
      "email" : "lasse.laasonen@ambientia.fi"
    },
    "version" : "1.0.0"
  },
  "servers" : [ {
    "url" : "https://hankeikkuna-test.vnv.fi/delegate/vahva",
    "description" : "Hankeikkuna test"
  } ],
  "security" : [ {
    "basicAuth" : [ ]
  } ],
  "paths" : {
    "/api/v1/kohdetyypit/{kieli}" : {
      "get" : {
        "summary" : "Hae Hankeikkunan kohdetyypit ja kohteen tarkenteet halutulla kielellä",
        "parameters" : [ {
          "name" : "kieli",
          "in" : "path",
          "description" : "Kieli, jolla tiedot halutaan. Vaihtoehdot: fi,sv",
          "required" : true,
          "style" : "simple",
          "explode" : false,
          "schema" : {
            "type" : "string"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Kohdetyypit halutulla kielellä",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/KohdeTyypit"
                }
              }
            }
          },
          "401" : {
            "description" : "Tunnistautuminen ei onnistunut"
          },
          "404" : {
            "description" : "Tietoja ei löydy halutulla kielellä"
          },
          "500" : {
            "description" : "Odottamaton virhe kutsun suorituksen aikana"
          }
        }
      }
    },
    "/api/v1/vahva-sidos/{caseRecno}" : {
      "get" : {
        "summary" : "Hae VAHVA-Hankeikkuna -sidoksen tiedot. Palauttaa 404, mikäli sidosta ei ole vielä tehty. Haku tehdään ensisijaisesti caseRecno -tiedolla, ja mikäli Hankeikkunan tietokannasta ei VAHVA-sidosta löydy tällä, kohteen hanketunnuksella mikäli sellainen on haussa annettu. Mikäli kohde ei löydy caseRecno:lla mutta löytyy hanketunnuksella, Hankeikkuna tekee haun yhteydessä implisiittisesti uuden VAHVA-sidoksen asian tasolla.",
        "parameters" : [ {
          "name" : "caseRecno",
          "in" : "path",
          "description" : "VAHVAn asian tekninen tunniste, Case.recno",
          "required" : true,
          "style" : "simple",
          "explode" : false,
          "schema" : {
            "type" : "string"
          }
        }, {
          "name" : "hanketunnus",
          "in" : "query",
          "description" : "VAHVAan migratoidun asian Hankeikkunan hanketunnus. Mahdollistaa näiden linkkaamisen VAHVAan",
          "required" : false,
          "style" : "form",
          "explode" : true,
          "schema" : {
            "type" : "string"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Sidos löytyi",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/VahvaSidos"
                }
              }
            }
          },
          "401" : {
            "description" : "Tunnistautuminen ei onnistunut"
          },
          "404" : {
            "description" : "Sidosta ei ole"
          },
          "500" : {
            "description" : "Odottamaton virhe kutsun suorituksen aikana"
          }
        }
      },
      "put" : {
        "summary" : "Päivitä VAHVA-Hankeikkuna -sidoksen tiedot.\nPäivityksen yhteydessä liitettyjä asiakirjoja voidaan lisätä tai poistaa.\n",
        "parameters" : [ {
          "name" : "caseRecno",
          "in" : "path",
          "description" : "VAHVAn asian tekninen tunniste, Case.recno",
          "required" : true,
          "style" : "simple",
          "explode" : false,
          "schema" : {
            "type" : "string"
          }
        } ],
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/SidosPyynto"
              }
            }
          }
        },
        "responses" : {
          "200" : {
            "description" : "Päivitetyt sidoksen tiedot",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/VahvaSidos"
                }
              }
            }
          },
          "401" : {
            "description" : "Tunnistautuminen ei onnistunut"
          },
          "404" : {
            "description" : "Sidosta ei ole"
          },
          "422" : {
            "description" : "Virheellinen syöte, virheilmoituksessa tarkempi kuvaus"
          },
          "500" : {
            "description" : "Virhe kutsun suorituksen aikana",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "post" : {
        "summary" : "Tee uusi VAHVA-Hankeikkuna -sidos. Luo Hankeikkunaan uuden hankkeen.\nHankeikkuna lukee saamiensa tietojen perusteella VAHVAsta asian tietoja, asian asiakirjojen tietoja ja tiedostoja ja vie nämä Hankeikkunaan. Lopputuloksena Hankeikkunaan on luotu uusi kohde. \n",
        "parameters" : [ {
          "name" : "caseRecno",
          "in" : "path",
          "description" : "VAHVAn asian tekninen tunniste, Case.recno",
          "required" : true,
          "style" : "simple",
          "explode" : false,
          "schema" : {
            "type" : "string"
          }
        } ],
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/SidosPyynto"
              }
            }
          }
        },
        "responses" : {
          "200" : {
            "description" : "Sidoksen tiedot - kohdetyyppi, tarkenne ja liitettävien tiedostojen tunnisteet ja aikaleimat",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/VahvaSidos"
                }
              }
            }
          },
          "401" : {
            "description" : "Tunnistautuminen ei onnistunut"
          },
          "409" : {
            "description" : "Sidos on jo olemassa annetulla tunnisteella"
          },
          "422" : {
            "description" : "Virheellinen syöte, virheilmoituksessa tarkempi kuvaus"
          },
          "500" : {
            "description" : "Virhe kutsun suorituksen aikana",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    }
  },
  "components" : {
    "schemas" : {
      "KohdeTyypit" : {
        "type" : "object",
        "properties" : {
          "kohdeTyypit" : {
            "type" : "array",
            "items" : {
              "$ref" : "#/components/schemas/KohdeTyyppi"
            }
          }
        },
        "example" : {
          "kohdeTyypit" : [ {
            "kohdeTyyppiKoodi" : 1,
            "kohdeTyyppiSelite" : "Toimielin",
            "kohdeTyypinTarkenteet" : [ {
              "kohdeTyypinTarkenneKoodi" : 1,
              "kohdeTyypinTarkenneSelite" : "Hallitus"
            }, {
              "kohdeTyypinTarkenneKoodi" : 2,
              "kohdeTyypinTarkenneSelite" : "Jaosto"
            }, {
              "kohdeTyypinTarkenneKoodi" : 3,
              "kohdeTyypinTarkenneSelite" : "Johtokunta"
            }, {
              "kohdeTyypinTarkenneKoodi" : 4,
              "kohdeTyypinTarkenneSelite" : "Johtoryhmä"
            }, {
              "kohdeTyypinTarkenneKoodi" : 5,
              "kohdeTyypinTarkenneSelite" : "Komitea"
            }, {
              "kohdeTyypinTarkenneKoodi" : 6,
              "kohdeTyypinTarkenneSelite" : "Lautakunta"
            }, {
              "kohdeTyypinTarkenneKoodi" : 7,
              "kohdeTyypinTarkenneSelite" : "Neuvosto"
            }, {
              "kohdeTyypinTarkenneKoodi" : 8,
              "kohdeTyypinTarkenneSelite" : "Neuvottelukunta"
            }, {
              "kohdeTyypinTarkenneKoodi" : 9,
              "kohdeTyypinTarkenneSelite" : "Ohjausryhmä"
            }, {
              "kohdeTyypinTarkenneKoodi" : 10,
              "kohdeTyypinTarkenneSelite" : "Sihteeristö"
            }, {
              "kohdeTyypinTarkenneKoodi" : 11,
              "kohdeTyypinTarkenneSelite" : "Toimikunta"
            }, {
              "kohdeTyypinTarkenneKoodi" : 12,
              "kohdeTyypinTarkenneSelite" : "Työryhmä"
            }, {
              "kohdeTyypinTarkenneKoodi" : 13,
              "kohdeTyypinTarkenneSelite" : "Valtuuskunta"
            } ]
          }, {
            "kohdeTyyppiKoodi" : 2,
            "kohdeTyyppiSelite" : "Strategia",
            "kohdeTyypinTarkenteet" : [ {
              "kohdeTyypinTarkenneKoodi" : 103,
              "kohdeTyypinTarkenneSelite" : "Valtioneuvostotasoinen strategia"
            }, {
              "kohdeTyypinTarkenneKoodi" : 104,
              "kohdeTyypinTarkenneSelite" : "Valtioneuvostotasoinen ohjelma"
            }, {
              "kohdeTyypinTarkenneKoodi" : 105,
              "kohdeTyypinTarkenneSelite" : "Ministeriötasoinen strategia"
            }, {
              "kohdeTyypinTarkenneKoodi" : 106,
              "kohdeTyypinTarkenneSelite" : "Ministeriötasoinen ohjelma"
            } ]
          }, {
            "kohdeTyyppiKoodi" : 3,
            "kohdeTyyppiSelite" : "Hanke"
          }, {
            "kohdeTyyppiKoodi" : 4,
            "kohdeTyyppiSelite" : "Lainsäädäntöhanke"
          } ]
        }
      },
      "KohdeTyyppi" : {
        "type" : "object",
        "properties" : {
          "kohdeTyyppiKoodi" : {
            "type" : "string"
          },
          "kohdeTyyppiSelite" : {
            "type" : "string"
          },
          "kohdeTyypinTarkenteet" : {
            "type" : "array",
            "items" : {
              "$ref" : "#/components/schemas/KohdeTyyppi_kohdeTyypinTarkenteet"
            }
          }
        }
      },
      "VahvaSidos" : {
        "required" : [ "kohdeTyyppiKoodi" ],
        "type" : "object",
        "properties" : {
          "kohdeTyyppiKoodi" : {
            "type" : "string",
            "description" : "Kohteen tyypin koodi. Vaihtoehdot luetaan Hankeikkunasta GET /api/v1/kohdetyypit -komennolla"
          },
          "kohdeAliTyyppiKoodi" : {
            "type" : "string",
            "description" : "Kohteen alityyppi - pakollinen joissakin kohdetyypeissä (toimielin ja strategia)"
          },
          "url" : {
            "type" : "string",
            "description" : "Linkki hankeikkunan kohteeseen Hankeikkunan käyttöliittymässä"
          },
          "tunnus" : {
            "type" : "string",
            "description" : "Kohteen tunnus Hankeikkunassa"
          },
          "asiaJulkaisuTapa" : {
            "$ref" : "#/components/schemas/AsiaJulkaisuTapa"
          },
          "asiakirjat" : {
            "type" : "array",
            "items" : {
              "$ref" : "#/components/schemas/AsiakirjaSidos"
            }
          }
        },
        "example" : {
          "kohdeTyyppiKoodi" : 2,
          "kohdeAliTyyppiKoodi" : 103,
          "url" : "https://hankeikkuna.vnv.fi/app#/hanke/30509/kuvaukset",
          "tunnus" : "VNK005:00/2019",
          "asiaJulkaisuTapa" : "sisäinenJaUlkoinen",
          "asiakirjat" : [ {
            "asiakirjaRecno" : 4218623,
            "fileId" : 89987,
            "muutosAikaleima" : "2018-07-12T12:42:01.456+02.00",
            "asiakirjaJulkaisuTapa" : "sisäinenJaUlkoinen"
          }, {
            "asiakirjaRecno" : 344321,
            "fileId" : 43321,
            "muutosAikaleima" : "2018-06-12T13:15:07.678+02.00",
            "asiakirjaJulkaisuTapa" : "sisäinenJaUlkoinenVainMetatiedot"
          }, {
            "asiakirjaRecno" : 432879,
            "fileId" : 5342432,
            "muutosAikaleima" : "2017-02-03T14:44:06.123+02.00",
            "asiakirjaJulkaisuTapa" : "sisäinenUlkoisestiVainMetatiedot"
          } ]
        }
      },
      "AsiakirjaSidos" : {
        "type" : "object",
        "properties" : {
          "recordRecno" : {
            "type" : "string",
            "description" : "VAHVAn asiakirjan tekninen tunniste, Record.recno"
          },
          "documentRecno" : {
            "type" : "string",
            "description" : "VAHVAn tiedoston tekninen tunniste, Document.recno"
          },
          "documentVersionRecno" : {
            "type" : "string",
            "description" : "VAHVAn tiedoston version tekninen tunniste, DocumentVersion.recno?"
          },
          "muutosAikaleima" : {
            "type" : "string",
            "description" : "VAHVAn tiedoston muutosaikaleima",
            "format" : "datetime"
          },
          "asiakirjaJulkaisuTapa" : {
            "$ref" : "#/components/schemas/AsiakirjaJulkaisuTapa"
          }
        }
      },
      "AsiaJulkaisuTapa" : {
        "type" : "string",
        "description" : "tieto, joka kontrolloi asian julkaisua Hankeikkunaan",
        "enum" : [ "kyllä", "peruttu" ]
      },
      "AsiakirjaJulkaisuTapa" : {
        "type" : "string",
        "description" : "tieto, joka kontrolloi asiakirjan julkaisua - minne julkaistaan (sisäisesti vaiko myös julkiseen verkkoon), ja julkaistaanko koko asiakirja vai pelkät metatiedot asiakirjasta",
        "enum" : [ "sisäinen", "sisäinenJaUlkoinen", "sisäinenJaUlkoinenVainMetatiedot", "sisäinenUlkoisestiVainMetatiedot", "peruttu" ]
      },
      "SidosPyynto" : {
        "required" : [ "toimija", "vahvaSidos" ],
        "type" : "object",
        "properties" : {
          "vahvaSidos" : {
            "$ref" : "#/components/schemas/VahvaSidos"
          },
          "toimija" : {
            "$ref" : "#/components/schemas/Toimija"
          }
        }
      },
      "Toimija" : {
        "required" : [ "sposti" ],
        "type" : "object",
        "properties" : {
          "sposti" : {
            "type" : "string",
            "description" : "Henkilön tunnisteena käytettävä sähköpostiosoite"
          }
        },
        "description" : "Yksilöivä tieto henkilölle, joka tekee asian viennin VAHVAsta Hankeikkunaan"
      },
      "Error" : {
        "type" : "object",
        "properties" : {
          "errorCode" : {
            "type" : "integer",
            "description" : "Virhekoodi"
          },
          "description" : {
            "type" : "string",
            "description" : "Virheen tekninen kuvaus"
          }
        },
        "description" : "Käytettävät virhekoodit\n  1 = tuntematon virhe,\n  2 = tuntematon vastuuorganisaatio,\n  3 = tiedosto ei saatavilla S2-rajapinnasta,\n  4 = kohde on arkistoitu Hankeikkunassa,\n  5 = kohde on jäädytetty Hankeikkunassa\n"
      },
      "KohdeTyyppi_kohdeTyypinTarkenteet" : {
        "type" : "object",
        "properties" : {
          "kohdeTyypinTarkenneKoodi" : {
            "type" : "string"
          },
          "kohdeTyypinTarkenneSelite" : {
            "type" : "string"
          }
        }
      }
    },
    "securitySchemes" : {
      "basicAuth" : {
        "type" : "http",
        "scheme" : "basic"
      }
    }
  }
}